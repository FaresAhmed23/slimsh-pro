"use strict";(self.webpackChunktheme_raed=self.webpackChunktheme_raed||[]).push([[621,897],{897:(t,e,r)=>{r.r(e),r.d(e,{default:()=>c});var i=r(29),a=r(517),c=function(){return(0,a.A)(function t(){(0,i.A)(this,t),this.filters={brands:new Set,priceRange:{min:0,max:1/0},ratings:new Set,inStockOnly:!1,sortBy:""},this.init()},[{key:"init",value:function(){this.isCategoryPage()&&(this.attachEvents(),this.initializePriceRange(),this.initializeFiltersFromURL())}},{key:"isCategoryPage",value:function(){return window.location.pathname.includes("/category/")||document.querySelector(".s-products-list")}},{key:"attachEvents",value:function(){this.attachPriceFilter(),this.attachRatingFilter(),this.attachStockFilter(),this.attachSortingFilter(),this.attachViewToggle(),this.attachClearFilters()}},{key:"initializePriceRange",value:function(){var t=document.querySelectorAll(".s-products-list-item"),e=1/0,r=0;t.forEach(function(t){var i=parseFloat(t.dataset.productPrice);i<e&&(e=i),i>r&&(r=i)});var i=document.querySelector(".price-from"),a=document.querySelector(".price-to");i&&a&&(i.placeholder="من ".concat(Math.floor(e)),a.placeholder="إلى ".concat(Math.ceil(r)))}},{key:"initializeFiltersFromURL",value:function(){var t=new URLSearchParams(window.location.search);t.has("min_price")&&(document.querySelector(".price-from").value=t.get("min_price")),t.has("max_price")&&(document.querySelector(".price-to").value=t.get("max_price")),t.toString()&&this.applyAllFilters()}},{key:"attachPriceFilter",value:function(){var t=this,e=document.querySelector(".apply-price-filter");e&&(e.addEventListener("click",function(){var e=parseFloat(document.querySelector(".price-from").value)||0,r=parseFloat(document.querySelector(".price-to").value)||1/0;t.filters.priceRange={min:e,max:r},t.applyAllFilters(),t.updateURL()}),["price-from","price-to"].forEach(function(t){var r=document.querySelector(".".concat(t));null==r||r.addEventListener("keypress",function(t){"Enter"===t.key&&e.click()})}))}},{key:"attachRatingFilter",value:function(){var t=this;document.querySelectorAll(".rating-filter").forEach(function(e){e.addEventListener("change",function(){var r=parseInt(e.value);e.checked?t.filters.ratings.add(r):t.filters.ratings.delete(r),t.applyAllFilters()})})}},{key:"attachStockFilter",value:function(){var t=this,e=document.querySelector(".in-stock-only");e&&e.addEventListener("change",function(e){t.filters.inStockOnly=e.target.checked,t.applyAllFilters()})}},{key:"attachSortingFilter",value:function(){var t=this,e=document.querySelector(".sort-products");e&&e.addEventListener("change",function(e){t.filters.sortBy=e.target.value,t.sortProducts(),t.updateURL()})}},{key:"attachViewToggle",value:function(){var t=document.querySelector(".view-grid"),e=document.querySelector(".view-list"),r=document.querySelector(".s-products-list");t&&e&&r&&("list"===(localStorage.getItem("products_view_mode")||"grid")&&(r.classList.add("list-view"),e.classList.add("active"),t.classList.remove("active")),t.addEventListener("click",function(){r.classList.remove("list-view"),t.classList.add("active"),e.classList.remove("active"),localStorage.setItem("products_view_mode","grid")}),e.addEventListener("click",function(){r.classList.add("list-view"),e.classList.add("active"),t.classList.remove("active"),localStorage.setItem("products_view_mode","list")}))}},{key:"attachClearFilters",value:function(){var t=this,e=document.querySelector(".clear-filters");e&&(document.querySelectorAll(".filters-container input").forEach(function(t){t.addEventListener("change",function(){e.classList.remove("hidden")})}),e.addEventListener("click",function(){t.filters={brands:new Set,priceRange:{min:0,max:1/0},ratings:new Set,inStockOnly:!1,sortBy:""},document.querySelectorAll('.filters-container input[type="checkbox"]').forEach(function(t){return t.checked=!1}),document.querySelectorAll('.filters-container input[type="number"]').forEach(function(t){return t.value=""}),document.querySelector(".sort-products").value="",t.showAllProducts(),e.classList.add("hidden"),t.updateURL()}))}},{key:"applyAllFilters",value:function(){var t=this,e=document.querySelectorAll(".s-products-list-item"),r=0;e.forEach(function(e){var i=t.shouldShowProduct(e);e.style.display=i?"":"none",i&&r++}),this.updateProductsCount(r),this.updateClearButton()}},{key:"shouldShowProduct",value:function(t){var e=parseFloat(t.dataset.productPrice);if(e<this.filters.priceRange.min||e>this.filters.priceRange.max)return!1;if(this.filters.ratings.size>0){var r=parseFloat(t.dataset.productRating)||0,i=!1;if(this.filters.ratings.forEach(function(t){r>=t&&(i=!0)}),!i)return!1}return!this.filters.inStockOnly||!t.querySelector(".out-of-stock")&&!t.querySelector("[data-out-of-stock='true']")}},{key:"sortProducts",value:function(){var t=this,e=document.querySelector(".s-products-list"),r=Array.from(document.querySelectorAll(".s-products-list-item"));r.sort(function(e,r){switch(t.filters.sortBy){case"price-asc":return parseFloat(e.dataset.productPrice)-parseFloat(r.dataset.productPrice);case"price-desc":return parseFloat(r.dataset.productPrice)-parseFloat(e.dataset.productPrice);case"rating":return(parseFloat(r.dataset.productRating)||0)-(parseFloat(e.dataset.productRating)||0);case"newest":return(r.dataset.productId||0)-(e.dataset.productId||0);case"bestseller":return(parseInt(r.dataset.productSold)||0)-(parseInt(e.dataset.productSold)||0);default:return 0}}),r.forEach(function(t){return e.appendChild(t)})}},{key:"showAllProducts",value:function(){document.querySelectorAll(".s-products-list-item").forEach(function(t){t.style.display=""}),this.updateProductsCount()}},{key:"updateProductsCount",value:function(t){var e=document.querySelector(".products-count span span");e&&(e.textContent=void 0!==t?t:document.querySelectorAll('.s-products-list-item:not([style*="display: none"])').length)}},{key:"updateClearButton",value:function(){var t=document.querySelector(".clear-filters");if(t){var e=this.filters.brands.size>0||this.filters.ratings.size>0||this.filters.priceRange.min>0||this.filters.priceRange.max<1/0||this.filters.inStockOnly||this.filters.sortBy;t.classList.toggle("hidden",!e)}}},{key:"updateURL",value:function(){var t=new URLSearchParams;this.filters.priceRange.min>0&&t.set("min_price",this.filters.priceRange.min),this.filters.priceRange.max<1/0&&t.set("max_price",this.filters.priceRange.max),this.filters.sortBy&&t.set("sort",this.filters.sortBy);var e="".concat(window.location.pathname).concat(t.toString()?"?"+t.toString():"");window.history.replaceState({},"",e)}}])}()}}]);