"use strict";(self.webpackChunktheme_raed=self.webpackChunktheme_raed||[]).push([[56,604],{604:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var a=n(29),r=n(517),i=function(){return(0,r.A)(function e(){(0,a.A)(this,e),this.storageKey="salla_recently_viewed",this.maxItems=15,this.init()},[{key:"init",value:function(){var e=this;(window.location.pathname.includes("/product/")||window.location.pathname.includes("/p/"))&&this.trackProduct(),this.displayProducts(),setInterval(function(){return e.displayProducts()},3e4)}},{key:"trackProduct",value:function(){var e=this;document.addEventListener("salla:product.fetched",function(t){var n,a,r,i,c=t.detail,s={id:c.id,name:c.name,url:c.url,image:(null===(n=c.image)||void 0===n?void 0:n.url)||(null===(a=c.images)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.url),price:c.price,sale_price:c.sale_price,currency:c.currency,rating:(null===(r=c.rating)||void 0===r?void 0:r.value)||0,category_id:c.category_id,brand:(null===(i=c.brand)||void 0===i?void 0:i.name)||"",timestamp:Date.now()};e.saveProduct(s)})}},{key:"saveProduct",value:function(e){var t=this.getProducts();(t=t.filter(function(t){return t.id!==e.id})).unshift(e),t=t.slice(0,this.maxItems),localStorage.setItem(this.storageKey,JSON.stringify(t)),document.dispatchEvent(new CustomEvent("recently-viewed:updated",{detail:t}))}},{key:"getProducts",value:function(){try{var e=localStorage.getItem(this.storageKey);if(!e)return[];var t=JSON.parse(e),n=Date.now()-864e5;return t.filter(function(e){return e.timestamp>n})}catch(e){return console.error("Error getting recently viewed products:",e),[]}}},{key:"displayProducts",value:function(){var e=this.getProducts();if(!(e.length<2)){var t=document.querySelectorAll(".recently-viewed-products");if(t.length){document.querySelectorAll(".recently-viewed-section").forEach(function(e){e.classList.remove("hidden"),e.classList.add("has-products")});var n=e.map(function(e){return'\n      <div class="recently-viewed-item relative group">\n        <a href="'.concat(e.url,'" class="block">\n          <div class="relative overflow-hidden rounded-lg mb-3">\n            <img src="').concat(e.image,'" \n                 alt="').concat(e.name,'" \n                 class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">\n            ').concat(e.sale_price?'\n              <div class="absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded">\n                خصم '.concat(Math.round((e.price-e.sale_price)/e.price*100),"%\n              </div>\n            "):"",'\n          </div>\n          <h3 class="text-sm font-semibold mb-2 line-clamp-2 group-hover:text-primary transition-colors">\n            ').concat(e.name,'\n          </h3>\n          <div class="flex items-center justify-between">\n            <div class="price-wrapper">\n              ').concat(e.sale_price?'\n                <span class="text-red-500 font-bold">'.concat(salla.money(e.sale_price),'</span>\n                <span class="text-gray-400 line-through text-sm mr-2">').concat(salla.money(e.price),"</span>\n              "):'\n                <span class="font-bold text-primary">'.concat(salla.money(e.price),"</span>\n              "),"\n            </div>\n            ").concat(e.rating>0?'\n              <div class="flex items-center">\n                <i class="sicon-star text-yellow-400 text-xs"></i>\n                <span class="text-xs text-gray-600 mr-1">'.concat(e.rating,"</span>\n              </div>\n            "):"","\n          </div>\n        </a>\n      </div>\n    ")}).join("");t.forEach(function(e){e.innerHTML=n})}}}}])}()}}]);