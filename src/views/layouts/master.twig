<!DOCTYPE html>
<html lang="{{ user.language.code }}" dir="{{ user.language.dir }}">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    {# Set global variables at the top for clarity #}
    {{ theme.settings.set('placeholder', 'images/placeholder.png') }}

    {% hook 'head:start' %}
    {% hook head %}
    
    {# Load fonts and icons first #}
    <link rel="stylesheet" href="{{ theme.font.path|cdn }}"/>
    <link rel="stylesheet" href="{{ 'fonts/sallaicons.css'|cdn }}"/>
    
    <link rel="stylesheet" href="http://localhost:8014/app.css?v={{ 'now'|date('U') }}">

    
    <style>
        :root {
            --font-main: '{{theme.font.name}}';
            --color-primary: {{ theme.color.primary }};
            --color-primary-dark: {{ theme.color.darker(0.15) }};
            --color-primary-light: {{ theme.color.lighter(0.15) }};
            --color-primary-reverse: {{ theme.color.reverse_text }};
        }
    </style>
    
    {% block styles %}{% endblock %}

    {% hook 'head:end' %}
</head>

{# Apply dynamic classes in a cleaner way #}
<body id="app" class="overflow-x-hidden 
    {% hook 'body:classes' %}
    {{ theme.settings.get('footer_is_dark') ? ' footer-is-dark' : ' footer-is-light' }}
    {{ theme.settings.get('topnav_is_dark') ? ' topnav-is-dark' : '' }}
    {{ theme.settings.get('sticky_add_to_cart') ? ' is-sticky-product-bar' : '' }}
">
    <div class="loader-init"></div>
    <noscript>
        To get full functionality of this site you need to enable JavaScript. Here is how
        <a href="https://www.enable-javascript.com/" rel="noreferrer" target="_blank">To enable JavaScript on webpage</a>.
    </noscript>

    <div class="app-inner flex flex-col min-h-full">
        {% hook 'body:start' %}
        
        {# Include header and footer components #}
        {% component 'header.header' %}
        
        {% block content %}{% endblock %}
        
        {% component 'footer.footer' %}
    </div>

    {% hook 'body:end' %}

    {# Defer non-critical scripts to improve page load speed #}
    {% include 'pages.partials.loading-screen-assets' %}
    <script defer data-cfasync="false" src="{{ 'product-card.js'|asset }}"></script>
    <script defer src="{{ 'main-menu.js'|asset }}"></script>
    <script defer src="{{ 'app.js' | asset }}"></script>
    {% block head_scripts %}{% endblock %}
    
    {# Pass variables to JavaScript #}
    <script data-cfasync="false">
        window.header_is_sticky = "{{theme.settings.get('header_is_sticky', 'Default Value')}}";
        window.imageZoom = "{{theme.settings.get('imageZoom')}}";
        window.can_access_wallet = {{ user.can_access_wallet | json_encode }};
    </script>
    
    {# Twilight Components #}
    <salla-offer-modal></salla-offer-modal>
    <salla-search></salla-search>

    {% if user.type=='guest' %}
        <salla-login-modal></salla-login-modal>
    {% endif %}
    
    {% block scripts %}{% endblock %}
</body>
</html>